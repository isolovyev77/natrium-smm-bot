#!/usr/bin/env python3
"""
–¢–µ—Å—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ Markdown –≤ HTML –¥–ª—è Telegram
"""

import re

def convert_markdown_to_html(text: str) -> str:
    """
    –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç Markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ HTML –¥–ª—è Telegram
    
    –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:
    - [—Ç–µ–∫—Å—Ç](URL) ‚Üí <a href="URL">—Ç–µ–∫—Å—Ç</a>
    - **—Ç–µ–∫—Å—Ç** ‚Üí <b>—Ç–µ–∫—Å—Ç</b>
    - *—Ç–µ–∫—Å—Ç* ‚Üí <i>—Ç–µ–∫—Å—Ç</i>
    """
    
    # 1. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Å—Å—ã–ª–∫–∏: [—Ç–µ–∫—Å—Ç](URL) ‚Üí <a href="URL">—Ç–µ–∫—Å—Ç</a>
    text = re.sub(
        r'\[([^\]]+)\]\(([^)]+)\)',
        r'<a href="\2">\1</a>',
        text
    )
    
    # 2. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç: **—Ç–µ–∫—Å—Ç** ‚Üí <b>—Ç–µ–∫—Å—Ç</b>
    text = re.sub(r'\*\*(.+?)\*\*', r'<b>\1</b>', text)
    
    # 3. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∫—É—Ä—Å–∏–≤: *—Ç–µ–∫—Å—Ç* ‚Üí <i>—Ç–µ–∫—Å—Ç</i>
    # –ù–æ –ù–ï —Ç—Ä–æ–≥–∞–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ * –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏ (–±—É–ª–ª–µ—Ç—ã)
    text = re.sub(r'(?<!^)(?<!\n)\*([^*\n]+?)\*', r'<i>\1</i>', text, flags=re.MULTILINE)
    
    return text


# –¢–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã
test_cases = [
    {
        "name": "–°—Å—ã–ª–∫–∞ –Ω–∞ PubMed",
        "input": "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç [PubMed](https://pubmed.ncbi.nlm.nih.gov/12345678/)",
        "expected": '–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç <a href="https://pubmed.ncbi.nlm.nih.gov/12345678/">PubMed</a>'
    },
    {
        "name": "–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞",
        "input": "üí™ **–†–ê–ó–ú–ò–ù–ö–ê: –ö–õ–Æ–ß –ö –†–ï–ó–£–õ–¨–¢–ê–¢–£**",
        "expected": "üí™ <b>–†–ê–ó–ú–ò–ù–ö–ê: –ö–õ–Æ–ß –ö –†–ï–ó–£–õ–¨–¢–ê–¢–£</b>"
    },
    {
        "name": "–ë—É–ª–ª–µ—Ç—ã —Å–æ —Å—Å—ã–ª–∫–∞–º–∏",
        "input": "‚Ä¢ —É–ª—É—á—à–∞–µ—Ç –ø–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ [PubMed](https://pubmed.ncbi.nlm.nih.gov/12345678/);",
        "expected": '‚Ä¢ —É–ª—É—á—à–∞–µ—Ç –ø–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ <a href="https://pubmed.ncbi.nlm.nih.gov/12345678/">PubMed</a>;'
    },
    {
        "name": "–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–µ–∫—Ü–∏–∏",
        "input": "üî• **–ù–ê–£–ö–ê**\n‚Ä¢ —Ñ–∞–∫—Ç 1\n‚Ä¢ —Ñ–∞–∫—Ç 2",
        "expected": "üî• <b>–ù–ê–£–ö–ê</b>\n‚Ä¢ —Ñ–∞–∫—Ç 1\n‚Ä¢ —Ñ–∞–∫—Ç 2"
    },
    {
        "name": "–ù–µ—Å–∫–æ–ª—å–∫–æ —Å—Å—ã–ª–æ–∫",
        "input": "–∏—Å—Ç–æ—á–Ω–∏–∫–∏: [PubMed](https://pubmed.ncbi.nlm.nih.gov/1/) –∏ [–í–û–ó](https://who.int/)",
        "expected": '–∏—Å—Ç–æ—á–Ω–∏–∫–∏: <a href="https://pubmed.ncbi.nlm.nih.gov/1/">PubMed</a> –∏ <a href="https://who.int/">–í–û–ó</a>'
    },
    {
        "name": "–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–æ—Å—Ç",
        "input": """üí™ **–†–ê–ó–ú–ò–ù–ö–ê: –ö–õ–Æ–ß –ö –†–ï–ó–£–õ–¨–¢–ê–¢–£**

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ: –≤—ã –ø—Ä–∏—Ö–æ–¥–∏—Ç–µ –≤ –∑–∞–ª, –∏ –ø–µ—Ä–≤—ã–µ 5 –º–∏–Ω—É—Ç –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –≤—Å—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É.

üî• **–ù–ê–£–ö–ê**
‚Ä¢ –ø–æ–≤—ã—à–∞–µ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –º—ã—à—Ü –Ω–∞ 2-3¬∞C [PubMed](https://pubmed.ncbi.nlm.nih.gov/12345678/)
‚Ä¢ —É–ª—É—á—à–∞–µ—Ç –Ω–µ–π—Ä–æ–º—ã—à–µ—á–Ω—É—é –ø—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç—å (–í–û–ó)

#–Ω–∞—Ç—Ä–∏—É–º—Ñ–∏—Ç–Ω–µ—Å #—Ä–∞–∑–º–∏–Ω–∫–∞""",
        "expected": """üí™ <b>–†–ê–ó–ú–ò–ù–ö–ê: –ö–õ–Æ–ß –ö –†–ï–ó–£–õ–¨–¢–ê–¢–£</b>

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ: –≤—ã –ø—Ä–∏—Ö–æ–¥–∏—Ç–µ –≤ –∑–∞–ª, –∏ –ø–µ—Ä–≤—ã–µ 5 –º–∏–Ω—É—Ç –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –≤—Å—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É.

üî• <b>–ù–ê–£–ö–ê</b>
‚Ä¢ –ø–æ–≤—ã—à–∞–µ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –º—ã—à—Ü –Ω–∞ 2-3¬∞C <a href="https://pubmed.ncbi.nlm.nih.gov/12345678/">PubMed</a>
‚Ä¢ —É–ª—É—á—à–∞–µ—Ç –Ω–µ–π—Ä–æ–º—ã—à–µ—á–Ω—É—é –ø—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç—å (–í–û–ó)

#–Ω–∞—Ç—Ä–∏—É–º—Ñ–∏—Ç–Ω–µ—Å #—Ä–∞–∑–º–∏–Ω–∫–∞"""
    }
]

print("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ Markdown ‚Üí HTML\n")

passed = 0
failed = 0

for i, test in enumerate(test_cases, 1):
    result = convert_markdown_to_html(test["input"])
    
    if result == test["expected"]:
        print(f"‚úÖ –¢–µ—Å—Ç {i}: {test['name']}")
        passed += 1
    else:
        print(f"‚ùå –¢–µ—Å—Ç {i}: {test['name']}")
        print(f"   –û–∂–∏–¥–∞–ª–æ—Å—å: {test['expected']}")
        print(f"   –ü–æ–ª—É—á–µ–Ω–æ:  {result}")
        failed += 1
    print()

print(f"\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã: {passed} –ø—Ä–æ–π–¥–µ–Ω–æ, {failed} –ø—Ä–æ–≤–∞–ª–µ–Ω–æ")

if failed == 0:
    print("‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã!")
else:
    print(f"‚ö†Ô∏è –ü—Ä–æ–≤–∞–ª–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤: {failed}")

# üìã CI/CD Setup - –°–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üìÖ 28 —è–Ω–≤–∞—Ä—è 2026

### ‚ú® –î–æ–±–∞–≤–ª–µ–Ω–æ

#### üîß –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã CI/CD

1. **`.github/workflows/deploy-new.yml`** - –£–ª—É—á—à–µ–Ω–Ω—ã–π GitHub Actions workflow
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `appleboy/ssh-action@v1.0.3` –≤–º–µ—Å—Ç–æ webfactory/ssh-agent
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `.env` –∏–∑ GitHub Secrets
   - –ë–æ–ª–µ–µ —á–∏—Å—Ç—ã–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π –∫–æ–¥
   - –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

2. **`COPILOT_CICD_SETUP.md`** - –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è Copilot
   - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Deploy Key
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ sudoers
   - Troubleshooting —Å–µ–∫—Ü–∏—è
   - –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã –¥–µ–ø–ª–æ—è
   - –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

3. **`QUICK_CICD_SETUP.md`** - –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞ 5 –º–∏–Ω—É—Ç
   - –ö—Ä–∞—Ç–∫–∏–π –≥–∞–π–¥ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
   - –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
   - –†–µ—à–µ–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –ø—Ä–æ–±–ª–µ–º

4. **`scripts/setup_deploy_key.sh`** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - –°–æ–∑–¥–∞–Ω–∏–µ SSH Deploy Key
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Git –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–ª—é—á–∞
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ sudoers –¥–ª—è systemctl –±–µ–∑ –ø–∞—Ä–æ–ª—è
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ systemd —Å–µ—Ä–≤–∏—Å–∞
   - –í—ã–≤–æ–¥ –∫–ª—é—á–µ–π –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ GitHub

5. **`scripts/README.md`** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å–∫—Ä–∏–ø—Ç–∞–º
   - –û–ø–∏—Å–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
   - –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–∏—Å—Ç–µ–º–µ

#### üìù –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`README.md`** - –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ CI/CD –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
   - –†–∞–∑–¥–µ–ª "–ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π –Ω–∞ Oracle Cloud" –æ–±–Ω–æ–≤–ª–µ–Ω
   - –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ω–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

### üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–µ–ø–ª–æ–µ

#### –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (webfactory/ssh-agent):
```yaml
- Checkout code
- Setup SSH (webfactory)
- Add to known_hosts
- Deploy via heredoc SSH
- Verify deployment (–æ—Ç–¥–µ–ª—å–Ω—ã–π step)
- Show logs (–æ—Ç–¥–µ–ª—å–Ω—ã–π step)
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –°–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSH
- –ù–µ—Å–∫–æ–ª—å–∫–æ steps = –º–µ–¥–ª–µ–Ω–Ω–µ–µ
- –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è .env
- –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ .env –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è

#### –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–± (appleboy/ssh-action):
```yaml
- Deploy in one step
  - Auto SSH setup
  - Auto update .env from secrets
  - Install dependencies
  - Restart service
  - Show status
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
‚úÖ –û–¥–∏–Ω —à–∞–≥ –≤–º–µ—Å—Ç–æ –ø—è—Ç–∏  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ .env –∏–∑ GitHub Secrets  
‚úÖ –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å SSH  
‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è  
‚úÖ –ß–∏—Å—Ç—ã–π –∏ —á–∏—Ç–∞–µ–º—ã–π –∫–æ–¥  

### üîë Deploy Key vs SSH Key

#### –°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥ (SSH Key):
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `ORACLE_SSH_KEY` –¥–ª—è –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É
- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ SSH
- –†–∏—Å–∫ —É—Ç–µ—á–∫–∏ –∫–ª—é—á–∞ = –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ VM

#### –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ (Deploy Key):
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `DEPLOY_KEY` —Ç–æ–ª—å–∫–æ –¥–ª—è git –æ–ø–µ—Ä–∞—Ü–∏–π
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞ (—Ç–æ–ª—å–∫–æ read —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
- SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É –æ—Ç–¥–µ–ª—å–Ω–æ
- –ë–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ DevOps

### üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- Sudoers –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ systemctl (–±–µ–∑ –ø–æ–ª–Ω–æ–≥–æ sudo)
- Deploy Key —Å read-only –¥–æ—Å—Ç—É–ø–æ–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ .env –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –°–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ GitHub Secrets

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–°–æ–∑–¥–∞–Ω–æ 3 —É—Ä–æ–≤–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**

1. **Quick Start** (QUICK_CICD_SETUP.md)
   - –î–ª—è —Ç–µ—Ö –∫—Ç–æ —Ö–æ—á–µ—Ç –±—ã—Å—Ç—Ä–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å
   - 5 –º–∏–Ω—É—Ç —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–∫—Ä–∏–ø—Ç–æ–º

2. **Copilot Guide** (COPILOT_CICD_SETUP.md)
   - –î–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤
   - –ü–æ–ª–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
   - Troubleshooting –∏ best practices

3. **Scripts** (scripts/README.md)
   - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### üéØ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–æ

#### –î–æ:
1. ‚úã –í—Ä—É—á–Ω—É—é SSH –∫ —Å–µ—Ä–≤–µ—Ä—É
2. ‚úã –í—Ä—É—á–Ω—É—é git pull
3. ‚úã –í—Ä—É—á–Ω—É—é —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env
4. ‚úã –í—Ä—É—á–Ω—É—é pip install
5. ‚úã –í—Ä—É—á–Ω—É—é systemctl restart

#### –ü–æ—Å–ª–µ:
1. ‚úÖ `git push origin main`
2. ü§ñ –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞ 1-2 –º–∏–Ω—É—Ç—ã

### üöÄ Workflow

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  GitHub Codespaces  ‚îÇ
‚îÇ  –∏–ª–∏ Local Dev      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚îÇ git push origin main
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  GitHub Actions     ‚îÇ
‚îÇ  (Ubuntu Runner)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚îÇ appleboy/ssh-action
           ‚îÇ + DEPLOY_KEY
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Oracle VM              ‚îÇ
‚îÇ  (/opt/natrium-smm-bot) ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ  1. git pull            ‚îÇ
‚îÇ  2. update .env         ‚îÇ
‚îÇ  3. pip install         ‚îÇ
‚îÇ  4. systemctl restart   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
    üéâ Bot Updated!
```

---

## üìã –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –Ω–æ–≤—ã–π CI/CD

### –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

1. **–ù–∞ Oracle VM:**
   ```bash
   cd /opt/natrium-smm-bot
   ./scripts/setup_deploy_key.sh
   ```

2. **–ù–∞ GitHub:**
   - –î–æ–±–∞–≤–∏—Ç—å Deploy Key (–ø—É–±–ª–∏—á–Ω—ã–π)
   - –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç DEPLOY_KEY (–ø—Ä–∏–≤–∞—Ç–Ω—ã–π)
   - –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å ORACLE_SSH_KEY ‚Üí –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è —Ä–µ–∑–µ—Ä–≤–∞

3. **–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:**
   ```bash
   rm .github/workflows/deploy.yml
   mv .github/workflows/deploy-new.yml .github/workflows/deploy.yml
   git commit -am "feat: migrate to new CI/CD with Deploy Key"
   git push origin main
   ```

### –ß—Ç–æ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

- ‚ùå `ORACLE_SSH_KEY` secret (–µ—Å–ª–∏ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω –ø—Ä—è–º–æ–π SSH)
- ‚ùå –°—Ç–∞—Ä—ã–π SSH –∫–ª—é—á –Ω–∞ VM (–µ—Å–ª–∏ —Å–æ–∑–¥–∞–ª–∏ –Ω–æ–≤—ã–π Deploy Key)
- ‚ùå –†—É—á–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ .env (—Ç–µ–ø–µ—Ä—å –∏–∑ Secrets)

---

## üéì –ß—Ç–æ –Ω–æ–≤–æ–≥–æ —É–∑–Ω–∞–ª Copilot

1. **Deploy Keys vs SSH Keys** - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –¥–ª—è CI/CD
2. **appleboy/ssh-action** - –ª—É—á—à–µ —á–µ–º webfactory –¥–ª—è –¥–µ–ø–ª–æ—è
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ .env** - —á–µ—Ä–µ–∑ envs –≤ workflow
4. **Sudoers –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –±–µ–∑ –ø–æ–ª–Ω–æ–≥–æ sudo
5. **–¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - Quick/Detailed/Technical

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ Deploy Key –Ω–∞ VM
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Git —Å SSH
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ sudoers –±–µ–∑ –ø–∞—Ä–æ–ª—è
- ‚úÖ GitHub Actions workflow —Å appleboy/ssh-action
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ .env
- ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

---

## üîÆ –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ

- [ ] Rollback –º–µ—Ö–∞–Ω–∏–∑–º (–æ—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏)
- [ ] Slack/Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–µ–ø–ª–æ–µ
- [ ] Staging –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- [ ] Health check endpoint –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–æ—Ç–∞
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
- [ ] Blue-green deployment

---

**–ê–≤—Ç–æ—Ä:** GitHub Copilot + Human Collaboration  
**–î–∞—Ç–∞:** 28 —è–Ω–≤–∞—Ä—è 2026  
**–í–µ—Ä—Å–∏—è:** 1.0.0
